<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Night Shift 1: Cameras & Patience</title>
    <style>
        body {
            background-color: #000;
            color: white;
            font-family: 'Courier New', Courier, monospace;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
            user-select: none;
        }

        #game-container {
            width: 1024px;
            height: 768px;
            background-color: #111;
            border: 4px solid #333;
            position: relative;
            display: flex;
            flex-direction: column;
            box-shadow: 0 0 50px rgba(0,0,0,0.9);
        }

        /* --- MAIN OFFICE VIEW --- */
        #office-view {
            flex-grow: 1;
            background: #000;
            position: relative;
            overflow: hidden;
            display: flex;
            justify-content: space-between;
            z-index: 5;
        }

        .door-frame {
            width: 180px;
            height: 100%;
            background: #222;
            border-left: 5px solid #111;
            border-right: 5px solid #111;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
        }

        .door-shutter {
            position: absolute;
            top: 0; width: 100%; height: 0%;
            background: repeating-linear-gradient(45deg, #333, #333 10px, #222 10px, #222 20px);
            transition: height 0.2s ease-in-out;
            z-index: 3;
            border-bottom: 5px solid #000;
        }
        .door-closed .door-shutter { height: 100%; }

        .hallway {
            width: 100%; height: 100%;
            background: #050505;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Enemy Faces in Window */
        .window-enemy {
            font-size: 90px;
            display: none;
            z-index: 2;
        }
        #enemy-window-left { color: #d32f2f; text-shadow: 0 0 20px red; }
        #enemy-window-right { color: #fff; filter: grayscale(100%); text-shadow: 0 0 20px white; }

        .room-bg {
            flex-grow: 1;
            background: radial-gradient(circle at center, #222 0%, #000 90%);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 150px;
            color: #111;
        }

        /* --- CONTROLS --- */
        .controls {
            margin-top: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            width: 80%;
            z-index: 10;
        }

        button {
            padding: 15px;
            font-weight: bold;
            cursor: pointer;
            border: 2px solid #555;
            background: #222;
            color: #fff;
            text-transform: uppercase;
            font-family: inherit;
        }
        button:active { background: #444; }
        .active { background: #fff !important; color: #000 !important; border-color: #fff !important; box-shadow: 0 0 15px #fff; }
        .btn-door.active { background: #d32f2f !important; color: white !important; border-color: red !important; box-shadow: 0 0 15px red; }

        /* --- CAMERA SYSTEM --- */
        #camera-trigger {
            height: 40px;
            background: #333;
            color: #aaa;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            border-top: 2px solid #555;
            z-index: 60;
            font-size: 14px;
        }
        #camera-trigger:hover { background: #444; color: white; }

        #camera-screen {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%; /* Cover office */
            background: #000;
            z-index: 50;
            display: none;
            flex-direction: column;
            border: 2px solid #555;
        }

        #cam-view {
            flex-grow: 1;
            position: relative;
            background: #050505;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }
        
        /* Camera Static Effect */
        #cam-view::after {
            content: "";
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAYAAACp8Z5+AAAAIklEQVQIW2NkQAKrVq36zwjjgzj//v37zwjjgzhhYWGMIAIAiOMAmn7+HL4AAAAASUVORK5CYII=');
            opacity: 0.1;
            animation: grain 0.1s steps(10) infinite;
            pointer-events: none;
        }

        .cam-content {
            font-size: 100px;
            color: #444;
            display: flex;
            gap: 50px;
        }
        
        #map {
            position: absolute;
            bottom: 20px;
            right: 20px;
            width: 250px;
            height: 200px;
            border: 2px solid #444;
            background: rgba(0,0,0,0.8);
            display: grid;
            grid-template-areas: 
                "cam1a cam1a"
                "cam1b cam1c"
                "cam2a cam2b"
                "cam4a cam4b";
            gap: 5px;
            padding: 10px;
        }
        
        .map-btn {
            background: #222;
            border: 1px solid #555;
            color: #888;
            font-size: 12px;
            padding: 5px;
        }
        .map-btn.selected { background: #4caf50; color: black; border-color: #0f0; }

        /* --- HUD --- */
        #hud {
            position: absolute;
            top: 20px; left: 20px; right: 20px;
            display: flex;
            justify-content: space-between;
            pointer-events: none;
            z-index: 60;
            text-shadow: 1px 1px 0 #000;
        }
        .stat { font-size: 24px; }
        .usage-bar { display: flex; gap: 5px; align-items: center; margin-top: 5px; }
        .usage-pip { width: 15px; height: 10px; background: #333; border: 1px solid #555; }
        .usage-pip.on { background: #4caf50; border-color: #0f0; }

        /* --- SCREENS (Start/End) --- */
        .overlay {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: #111;
            z-index: 100;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        .hidden { display: none !important; }

        @keyframes grain {
            0%, 100% { transform: translate(0, 0); }
            10% { transform: translate(-5%, -5%); }
            20% { transform: translate(-10%, 5%); }
            30% { transform: translate(5%, -10%); }
            40% { transform: translate(-5%, 15%); }
            50% { transform: translate(-10%, 5%); }
            60% { transform: translate(15%, 0); }
            70% { transform: translate(0, 10%); }
            80% { transform: translate(3%, 35%); }
            90% { transform: translate(-10%, 10%); }
        }
    </style>
</head>
<body>

<div id="game-container">

    <div id="start-screen" class="overlay">
        <h1>NIGHT SHIFT 1</h1>
        <p>Survive until 6 AM.</p>
        <div style="text-align: left; margin: 20px; color: #aaa; font-size: 14px;">
            <p>1. Check Cameras (Bottom Bar) to track enemies.</p>
            <p>2. If they appear at your door (Window), CLOSE IT.</p>
            <p>3. They will wait a few seconds before attacking. Don't panic, but be quick.</p>
        </div>
        <button onclick="startGame()">START NIGHT</button>
    </div>

    <div id="game-over" class="overlay hidden">
        <h1 style="color: red; font-size: 60px;">GAME OVER</h1>
        <p>You were too slow.</p>
        <button onclick="location.reload()">TRY AGAIN</button>
    </div>
    
    <div id="win-screen" class="overlay hidden">
        <h1 style="color: #4caf50; font-size: 60px;">6:00 AM</h1>
        <p>Shift Complete.</p>
        <button onclick="location.reload()">LEAVE</button>
    </div>

    <div id="hud">
        <div>
            <div class="stat" id="ui-time">12 AM</div>
            <div style="font-size: 12px; color: #888;">Night 1</div>
        </div>
        <div style="text-align: right;">
            <div class="stat" id="ui-power">100%</div>
            <div class="usage-bar">
                <span style="font-size: 12px; margin-right: 5px;">USAGE:</span>
                <div class="usage-pip" id="pip1"></div>
                <div class="usage-pip" id="pip2"></div>
                <div class="usage-pip" id="pip3"></div>
                <div class="usage-pip" id="pip4"></div>
            </div>
        </div>
    </div>

    <div id="office-view">
        <div class="door-frame">
            <div class="door-shutter" id="door-l"></div>
            <div class="hallway">
                <div class="window-enemy" id="enemy-window-left">üëπ</div>
            </div>
            <div class="controls">
                <button class="btn-door" id="btn-door-l" onclick="toggleDoor('left')">DOOR</button>
                <button class="btn-light" id="btn-light-l" onmousedown="toggleLight('left', true)" onmouseup="toggleLight('left', false)" onmouseleave="toggleLight('left', false)">LIGHT</button>
            </div>
        </div>

        <div class="room-bg">
            <span style="opacity: 0.1;">‚ò¢</span>
        </div>

        <div class="door-frame">
            <div class="door-shutter" id="door-r"></div>
            <div class="hallway">
                <div class="window-enemy" id="enemy-window-right">üíÄ</div>
            </div>
            <div class="controls">
                <button class="btn-door" id="btn-door-r" onclick="toggleDoor('right')">DOOR</button>
                <button class="btn-light" id="btn-light-r" onmousedown="toggleLight('right', true)" onmouseup="toggleLight('right', false)" onmouseleave="toggleLight('right', false)">LIGHT</button>
            </div>
        </div>
    </div>

    <div id="camera-screen">
        <div style="padding: 10px 20px; background: #222; border-bottom: 1px solid #444; display: flex; justify-content: space-between;">
            <span style="color: red; animation: blink 1s infinite;">‚óè REC</span>
            <span id="cam-name">CAM 1A - STAGE</span>
        </div>
        
        <div id="cam-view">
            <div class="cam-content" id="cam-render"></div>
        </div>

        <div id="map">
            <button class="map-btn" style="grid-area: cam1a" onclick="switchCam('1A')">CAM 1A (Stage)</button>
            <button class="map-btn" style="grid-area: cam1b" onclick="switchCam('1B')">CAM 1B (Dining)</button>
            <button class="map-btn" style="grid-area: cam1c" onclick="switchCam('1C')">CAM 1C (Restrooms)</button>
            <button class="map-btn" style="grid-area: cam2a" onclick="switchCam('2A')">CAM 2A (W. Hall)</button>
            <button class="map-btn" style="grid-area: cam2b" onclick="switchCam('2B')">CAM 2B (E. Hall)</button>
            <button class="map-btn" style="grid-area: cam4a" onclick="switchCam('4A')">CAM 4A (W. Door)</button>
            <button class="map-btn" style="grid-area: cam4b" onclick="switchCam('4B')">CAM 4B (E. Door)</button>
        </div>
    </div>

    <div id="camera-trigger" onclick="toggleCameraSystem()">
        <span style="letter-spacing: 2px;">[ MONITOR ]</span>
    </div>

</div>

<script>
    // --- CONFIGURATION ---
    const TICK_RATE = 1000; // 1 second per tick
    const NIGHT_LENGTH_MINUTES = 4; // Total real time length of night
    const HOUR_TICKS = (NIGHT_LENGTH_MINUTES * 60) / 6; 
    
    // AI SETTINGS (0.1 = 10% chance to move per second)
    const AI_CHANCE_RED = 0.25; 
    const AI_CHANCE_SKULL = 0.15;
    
    // ATTACK PATIENCE (Seconds they wait at the door before killing you)
    const ATTACK_DELAY_MIN = 4; 
    const ATTACK_DELAY_MAX = 8;

    // --- GAME STATE ---
    let state = {
        playing: false,
        power: 100,
        timeTicks: 0,
        usage: 1,
        camerasOpen: false,
        currentCam: '1A',
        
        // Left Side (Red)
        leftDoor: false,
        leftLight: false,
        leftPos: 0, // 0:Stage, 1:Dining, 2:W.Hall, 3:W.Door, 4:AT_WINDOW
        leftAttackTimer: 0,

        // Right Side (Skull)
        rightDoor: false,
        rightLight: false,
        rightPos: 0, // 0:Stage, 1:Restrooms, 2:E.Hall, 3:E.Door, 4:AT_WINDOW
        rightAttackTimer: 0
    };

    let gameTimer;

    // --- ROOM DEFINITIONS ---
    // Red Path: Stage(0) -> Dining(1) -> W.Hall(2) -> W.Door(3) -> WINDOW(4)
    // Skull Path: Stage(0) -> Restrooms(1) -> E.Hall(2) -> E.Door(3) -> WINDOW(4)
    
    function startGame() {
        document.getElementById('start-screen').classList.add('hidden');
        state.playing = true;
        gameTimer = setInterval(gameLoop, TICK_RATE);
        updateVisuals();
    }

    function gameLoop() {
        if (!state.playing) return;

        // 1. Time
        state.timeTicks++;
        let hour = 12 + Math.floor(state.timeTicks / HOUR_TICKS);
        if (hour > 12) hour -= 12;
        document.getElementById('ui-time').innerText = hour + " AM";
        
        if (Math.floor(state.timeTicks / HOUR_TICKS) === 6) {
            endGame(true);
            return;
        }

        // 2. Power Drain
        let drain = 0.1; // Base usage
        if (state.leftDoor) drain += 0.3;
        if (state.rightDoor) drain += 0.3;
        if (state.leftLight) drain += 0.3;
        if (state.rightLight) drain += 0.3;
        if (state.camerasOpen) drain += 0.2;

        state.power -= drain;
        if (state.power <= 0) {
            state.power = 0;
            triggerPowerOutage();
        }
        document.getElementById('ui-power').innerText = Math.floor(state.power) + "%";
        updateUsageMeter(drain);

        // 3. AI Logic
        handleAI();
    }

    function handleAI() {
        // --- RED (LEFT) ---
        if (state.leftPos < 4 && Math.random() < AI_CHANCE_RED) {
            state.leftPos++;
            if(state.leftPos === 4) {
                // Just arrived at window. Set Attack Timer.
                state.leftAttackTimer = getRandomInt(ATTACK_DELAY_MIN, ATTACK_DELAY_MAX);
            }
        }
        // Attack Logic
        if (state.leftPos === 4) {
            if (state.leftDoor) {
                // Blocked! Reset after a moment
                if (Math.random() < 0.4) {
                    state.leftPos = 0; // Go back to stage
                    console.log("Red blocked, returning to stage");
                }
            } else {
                // Door open, countdown to death
                state.leftAttackTimer--;
                if (state.leftAttackTimer <= 0) jumpscare('RED');
            }
        }

        // --- SKULL (RIGHT) ---
        if (state.rightPos < 4 && Math.random() < AI_CHANCE_SKULL) {
            state.rightPos++;
            if(state.rightPos === 4) {
                state.rightAttackTimer = getRandomInt(ATTACK_DELAY_MIN, ATTACK_DELAY_MAX);
            }
        }
        // Attack Logic
        if (state.rightPos === 4) {
            if (state.rightDoor) {
                if (Math.random() < 0.4) state.rightPos = 0; 
            } else {
                state.rightAttackTimer--;
                if (state.rightAttackTimer <= 0) jumpscare('SKULL');
            }
        }

        // Update Camera View if open
        if (state.camerasOpen) renderCamera();
        
        // Update Window Visuals (The eyes outside)
        updateWindowVisuals();
    }

    // --- CONTROLS ---

    function toggleDoor(side) {
        if (!state.playing || state.power <= 0) return;
        if (side === 'left') {
            state.leftDoor = !state.leftDoor;
            document.getElementById('door-l').parentElement.classList.toggle('door-closed', state.leftDoor);
            document.getElementById('btn-door-l').classList.toggle('active', state.leftDoor);
        } else {
            state.rightDoor = !state.rightDoor;
            document.getElementById('door-r').parentElement.classList.toggle('door-closed', state.rightDoor);
            document.getElementById('btn-door-r').classList.toggle('active', state.rightDoor);
        }
    }

    function toggleLight(side, on) {
        if (!state.playing || state.power <= 0) return;
        if (side === 'left') {
            state.leftLight = on;
            document.getElementById('btn-light-l').classList.toggle('active', on);
        } else {
            state.rightLight = on;
            document.getElementById('btn-light-r').classList.toggle('active', on);
        }
        updateWindowVisuals();
    }

    function updateWindowVisuals() {
        // You only see them at the window (pos 4) if the light is ON
        const elRed = document.getElementById('enemy-window-left');
        const elSkull = document.getElementById('enemy-window-right');

        if (state.leftPos === 4 && state.leftLight) elRed.style.display = 'block';
        else elRed.style.display = 'none';

        if (state.rightPos === 4 && state.rightLight) elSkull.style.display = 'block';
        else elSkull.style.display = 'none';
    }

    // --- CAMERA SYSTEM ---

    function toggleCameraSystem() {
        if (!state.playing || state.power <= 0) return;
        state.camerasOpen = !state.camerasOpen;
        
        const camScreen = document.getElementById('camera-screen');
        const trigger = document.getElementById('camera-trigger');
        
        if (state.camerasOpen) {
            camScreen.style.display = 'flex';
            trigger.innerHTML = "[ CLOSE MONITOR ]";
            switchCam(state.currentCam); // Refresh view
        } else {
            camScreen.style.display = 'none';
            trigger.innerHTML = "[ MONITOR ]";
        }
    }

    function switchCam(camID) {
        state.currentCam = camID;
        document.getElementById('cam-name').innerText = "CAM " + camID;
        
        // Highlight button
        document.querySelectorAll('.map-btn').forEach(b => b.classList.remove('selected'));
        // Find button with specific text or area (simplified selector here)
        // In a full app we'd ID buttons, but here:
        const btns = document.querySelectorAll('.map-btn');
        btns.forEach(b => { if(b.innerHTML.includes(camID)) b.classList.add('selected'); });

        renderCamera();
    }

    function renderCamera() {
        const view = document.getElementById('cam-render');
        view.innerHTML = ""; // Clear current

        // Logic: Is anyone in this room?
        let content = "";
        
        // Red Logic
        if (state.currentCam === '1A' && state.leftPos === 0) content += `<span style="color:#d32f2f">üëπ</span>`;
        if (state.currentCam === '1B' && state.leftPos === 1) content += `<span style="color:#d32f2f">üëπ</span>`;
        if (state.currentCam === '2A' && state.leftPos === 2) content += `<span style="color:#d32f2f">üëπ</span>`;
        if (state.currentCam === '4A' && state.leftPos === 3) content += `<span style="color:#d32f2f">üëπ</span>`;

        // Skull Logic
        if (state.currentCam === '1A' && state.rightPos === 0) content += `<span style="color:#fff">üíÄ</span>`;
        if (state.currentCam === '1C' && state.rightPos === 1) content += `<span style="color:#fff">üíÄ</span>`;
        if (state.currentCam === '2B' && state.rightPos === 2) content += `<span style="color:#fff">üíÄ</span>`;
        if (state.currentCam === '4B' && state.rightPos === 3) content += `<span style="color:#fff">üíÄ</span>`;

        if (content === "") content = "<span style='font-size:30px; color:#333'>(EMPTY)</span>";
        
        view.innerHTML = content;
    }

    // --- UTILS ---

    function updateUsageMeter(drain) {
        // Just for visuals, how many pips to light up
        for(let i=1; i<=4; i++) {
            document.getElementById('pip'+i).classList.remove('on');
        }
        if (drain > 0.3) document.getElementById('pip1').classList.add('on');
        if (drain > 0.5) document.getElementById('pip2').classList.add('on');
        if (drain > 0.8) document.getElementById('pip3').classList.add('on');
        if (drain > 1.0) document.getElementById('pip4').classList.add('on');
    }

    function getRandomInt(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    function triggerPowerOutage() {
        state.camerasOpen = false;
        document.getElementById('camera-screen').style.display = 'none';
        
        // Open doors
        state.leftDoor = false; state.rightDoor = false;
        state.leftLight = false; state.rightLight = false;
        document.querySelector('.controls').style.display = 'none'; // Disable controls
        
        // Darken Room
        document.getElementById('office-view').style.opacity = '0.3';
        
        setTimeout(() => jumpscare('POWER'), 5000);
    }

    function jumpscare(type) {
        state.playing = false;
        clearInterval(gameTimer);
        document.getElementById('game-over').classList.remove('hidden');
        document.getElementById('game-over').querySelector('p').innerText = type + " CAUGHT YOU";
    }

    function endGame(win) {
        state.playing = false;
        clearInterval(gameTimer);
        document.getElementById('win-screen').classList.remove('hidden');
    }

</script>
</body>
</html>
